<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indicadores Complejos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f1c40f;
            --danger-color: #e74c3c;
            --info-color: #9b59b6;
            --background-color: #f8f9fa;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 20px;
            color: var(--primary-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: var(--primary-color);
            margin: 0;
            font-weight: 500;
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .select-container {
            position: relative;
        }

        select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            appearance: none;
            background-color: white;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        select:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        .chart-container {
            position: relative;
            height: 500px;
            margin: 40px 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .metric-card {
            padding: 20px;
            border-radius: 8px;
            background: var(--background-color);
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 500;
            margin: 10px 0;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert.warning {
            background: #fde8e8;
            color: var(--danger-color);
        }

        .alert.success {
            background: #e8faf0;
            color: var(--success-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Indicadores de Desempeño</h1>
        </div>
        
        <div class="filters">
            <div class="select-container">
                <select id="supervisor" onchange="cargarAsesores()">
                    <option value="">Seleccionar supervisor...</option>
                </select>
            </div>
            <div class="select-container">
                <select id="asesor" onchange="actualizarDashboard()">
                    <option value="">Seleccionar asesor...</option>
                </select>
            </div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card">
                <div>TNPS Actual</div>
                <div id="tnps-value" class="metric-value">-</div>
                <div class="meta">Meta: 73%</div>
            </div>
            <div class="metric-card">
                <div>TX Actual</div>
                <div id="tx-value" class="metric-value">-</div>
                <div class="meta">Meta: 79%</div>
            </div>
            <div class="metric-card">
                <div>Calidad</div>
                <div id="calidad-value" class="metric-value">-</div>
                <div class="meta">Meta: 84%</div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="chart"></canvas>
        </div>

        <div id="alert" class="alert"></div>
    </div>

    <script>
        Chart.register(ChartDataLabels);
        let myChart = null;
        
        const data = { 
            "Hoja2":[
                 {
                  "ASESOR": "CARLOS SANCHEZ ADRIANA ANGELA",
                  "TNPS": 0.6755455712451861,
                  "TX": 0.5949004975124378,
                  "CALIDAD": 0.7503,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "LATURE OTOYA ALEJANDRA RAFAELA",
                  "TNPS": 0.7272727272727273,
                  "TX": 0.6114130434782609,
                  "CALIDAD": 0.78125,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "CUBA BEDOYA ALESSANDRA",
                  "TNPS": 0.6321284238886394,
                  "TX": 0.746530715857167,
                  "CALIDAD": 0.7304,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "ZEGARRA CARAHUATAY AMANDA GRACE",
                  "TNPS": 0.7272727272727273,
                  "TX": 0.6683673469387755,
                  "CALIDAD": 0.7498333333333335,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "MARCELO ESCUDERO ANDREA ELIZABETH",
                  "TNPS": 0.7291637186925145,
                  "TX": 0.7570144405135394,
                  "CALIDAD": 0.8875,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "CATAÑO VILLEGAS ANDREA EMILY",
                  "TNPS": 0.5185185185185185,
                  "TX": 0.6642335766423357,
                  "CALIDAD": 0.89955,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "ACUÑA CAMPOS ANGELES RUBY",
                  "TNPS": 0.7363636363636363,
                  "TX": 0.6371268656716418,
                  "CALIDAD": 0.6331,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "PORRAS VALLEJOS ANTHONY JAMES",
                  "TNPS": 0.5487804878048781,
                  "TX": 0.5508196721311476,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "CHUAN MUNGUIA AQUILES JEAMPIER",
                  "TNPS": 0.7165991902834008,
                  "TX": 0.7597864768683275,
                  "CALIDAD": 0.8040800000000001,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "JARA GAMARRA ARIAN HATSUMI",
                  "TNPS": 0.6363636363636364,
                  "TX": 0.5563139931740614,
                  "CALIDAD": 0.8843666666666667,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "PIZANGO RIVAS ARYSS ALMENDRA",
                  "TNPS": 0.7739130434782608,
                  "TX": 0.3827893175074184,
                  "CALIDAD": 0.7970999999999999,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "PEREZ TREVEJO AURORA ISABEL",
                  "TNPS": 0.7595548217452455,
                  "TX": 0.7585966644722405,
                  "CALIDAD": 0.8411499999999998,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "BERNACHEA JAVIER BERNARDO FORTUNATO",
                  "TNPS": 0.6515151515151515,
                  "TX": 0.7507930214115781,
                  "CALIDAD": 0.85,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "AROTINCO LOPEZ BETSABE DAYANNA",
                  "TNPS": 0.5660316780821918,
                  "TX": 0.680003238341969,
                  "CALIDAD": 0.89735,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "HERMOZA CONDORI BRIAN JOAQUIN",
                  "TNPS": 0.7793427230046949,
                  "TX": 0.7306930693069307,
                  "CALIDAD": 0.85,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "CHUI ALVAREZ BRIGUITTE SINDEL SUSANA",
                  "TNPS": 0.7011494252873564,
                  "TX": 0.7568807339449541,
                  "CALIDAD": 0.825,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "SARTORI RIOJA CARLA DANIELA",
                  "TNPS": 0.7355371900826446,
                  "TX": 0.8571428571428571,
                  "CALIDAD": 0.7777000000000001,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "VILLALOBOS ZULOETA CARLA NELIDAD",
                  "TNPS": 0.5898706896551724,
                  "TX": 0.6820803573620008,
                  "CALIDAD": 0.8062999999999999,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "BARRIOS LOLI CARLOS ANTONIO",
                  "TNPS": 0.6209677419354839,
                  "TX": 0.7432216905901117,
                  "CALIDAD": 0.9528333333333334,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "ORDINOLA ORDINOLA CARLOS CARLOS",
                  "TNPS": 0.6296296296296297,
                  "TX": 0.8035714285714286,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "VARGAS COBOS CESAR RODRIGO",
                  "TNPS": 0.8092105263157895,
                  "TX": 0.8083623693379791,
                  "CALIDAD": 1,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "TORRES MALDONADO CHRISTOPHER GERARD",
                  "TNPS": 0.7241379310344828,
                  "TX": 0.38461538461538464,
                  "CALIDAD": 0.8143,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "QUIROZ VILLAFRANCA DANIEL ALBERTO",
                  "TNPS": 0.7464788732394366,
                  "TX": 0.46634615384615385,
                  "CALIDAD": 0.73495,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "ALIAGA HURTADO DANIEL ALEJANDRO",
                  "TNPS": 0.7387387387387387,
                  "TX": 0.7733887733887734,
                  "CALIDAD": 0.9042,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "LOZANO MENEZ DANUSKA LOZANO",
                  "TNPS": 0.8113207547169812,
                  "TX": 0.7784431137724551,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "MONTES GUZMAN DEISY SUSANA",
                  "TNPS": 0.7945205479452054,
                  "TX": 0.6708860759493671,
                  "CALIDAD": 0.8568000000000001,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "LOPEZ ZEGARRA DENILSON ALDAIR",
                  "TNPS": 0.7990196078431373,
                  "TX": 0.49891250481801663,
                  "CALIDAD": 0.791,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "FLORES OLIVOS DIANA LISBETH",
                  "TNPS": 0.6845637583892618,
                  "TX": 0.7275362318840579,
                  "CALIDAD": 0.83355,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "QUINTANA DURAND DIANA MIRELLA",
                  "TNPS": 0.5575396825396826,
                  "TX": 0.7960810789088746,
                  "CALIDAD": 0.820275,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "QUIÑONEZ ALVA DIEGO MARCIAL",
                  "TNPS": 0.6767676767676768,
                  "TX": 0.6474358974358975,
                  "CALIDAD": 0.89975,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "REMIGIO MARTINEZ ELMER ALEJANDRO",
                  "TNPS": 0.6366666666666667,
                  "TX": 0.7881750465549349,
                  "CALIDAD": 0.79885,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "PAIVA ESTEVEZ EVELIN ROXANA",
                  "TNPS": 0.7868852459016393,
                  "TX": 0.74375,
                  "CALIDAD": 1,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "LLANOS SPARROW EVER LUIS",
                  "TNPS": 0.8,
                  "TX": 0.6684491978609626,
                  "CALIDAD": 0.82765,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "QUEZADA AGUILAR FABRRIZIO DEL PIERO",
                  "TNPS": 0.4166666666666667,
                  "TX": 0.7971473851030111,
                  "CALIDAD": 0.7147333333333333,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "MOTTA OLAYA FIORELLA ARACELY",
                  "TNPS": 0.6454545454545455,
                  "TX": 0.6454767726161369,
                  "CALIDAD": 0.8096,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "FERNANDEZ CORREA FLOR DE MARIA",
                  "TNPS": 0.5147058823529411,
                  "TX": 0.723404255319149,
                  "CALIDAD": 0,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "AQUINO LA ROSA FRANCISCO JAVIER",
                  "TNPS": 0.6349206349206349,
                  "TX": 0.780327868852459,
                  "CALIDAD": 0.9178000000000001,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "LUNA VICTORIA VARGAS GABRIEL EDUARDO",
                  "TNPS": 0.7936507936507936,
                  "TX": 0.728448275862069,
                  "CALIDAD": 0.9269499999999999,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "QUIROZ CAMPOS GABRIELA AZUCENA",
                  "TNPS": 0.6032608695652174,
                  "TX": 0.6832579185520362,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "RONDOY ORTIZ GEORJDY ALAIN",
                  "TNPS": 0.7857142857142857,
                  "TX": 0.8302583025830258,
                  "CALIDAD": 0.8952,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "QUISOCALA MAMANI GIANFRANCO WILDER",
                  "TNPS": 0.6640625,
                  "TX": 0.7451523545706371,
                  "CALIDAD": 0.8587,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "AGUILAR YBAÑEZ GINA MARISOL",
                  "TNPS": 0.6257668711656442,
                  "TX": 0.7881219903691814,
                  "CALIDAD": 0.96645,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "PAREDES RAFAEL GISELA MARIA",
                  "TNPS": 0.6666666666666666,
                  "TX": 0.7076923076923077,
                  "CALIDAD": 0.8164,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "CALDERON SOTO HELBER OSWALDO",
                  "TNPS": 0.6774322169059012,
                  "TX": 0.7853623649078194,
                  "CALIDAD": 0.7464,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "CHAPOÑAN SANCHEZ HENRY ENDRIK",
                  "TNPS": 0.9308510638297872,
                  "TX": 0.650515995872033,
                  "CALIDAD": 0.833825,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "CORREA CONDORI HENRY MAXIMILIANO",
                  "TNPS": 0.7650602409638554,
                  "TX": 0.7758620689655172,
                  "CALIDAD": 0.8848,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "SANCHEZ CASTILLO HILARY MELANIE",
                  "TNPS": 0.5,
                  "TX": 0.7707182320441989,
                  "CALIDAD": 0.91875,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "CASTRO FUENTES IAM ALEXIS",
                  "TNPS": 0.7195121951219512,
                  "TX": 0.7298850574712644,
                  "CALIDAD": 0.8311000000000001,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "MORAN ROSALES ISABEL CRISTINA",
                  "TNPS": 0.7319587628865979,
                  "TX": 0.7199453551912568,
                  "CALIDAD": 0.71634,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "ZEGARRA CARPIO ISABEL",
                  "TNPS": 0.6810344827586207,
                  "TX": 0.7713414634146342,
                  "CALIDAD": 0.8061999999999999,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "GUTIERREZ CARRILLO JACKELINE JUDITH",
                  "TNPS": 0.8461538461538461,
                  "TX": 0.7254901960784313,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "SANTOS GAMARRA JACQUELINE JESUS",
                  "TNPS": 0.7352941176470589,
                  "TX": 0.7202797202797203,
                  "CALIDAD": 0.8779666666666667,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "ORE QQUEHUE JANET ESTEFANIA",
                  "TNPS": 0.6388888888888888,
                  "TX": 0.6746987951807228,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "HUAMAN ARAMBURU JANILVA OCTAVIA",
                  "TNPS": 0.38492063492063494,
                  "TX": 0.6716372489348752,
                  "CALIDAD": 0.6740999999999999,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "PARADO COLLAHUACHO JEANPIER ADRIAN",
                  "TNPS": 0.5462184873949579,
                  "TX": 0.7986425339366516,
                  "CALIDAD": 0.6740999999999999,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "SANCHEZ VERGARAY JENNIFER YOHANNA",
                  "TNPS": 0.7666666666666667,
                  "TX": 0.6577181208053692,
                  "CALIDAD": 0.6945,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "RETO CHUMACERO JENNY LIZBETH",
                  "TNPS": 0.6989247311827957,
                  "TX": 0.6778242677824268,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "GALVEZ JUAREZ JEREMÍAS",
                  "TNPS": 0.6176470588235294,
                  "TX": 0.7213114754098361,
                  "CALIDAD": 0.7397,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "MEDINA REVOLLEDO JHONATAN ISAIAS",
                  "TNPS": 0.7508333333333332,
                  "TX": 0.6824144291863087,
                  "CALIDAD": 0.7798,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "GONZALES VASQUEZ JIMY",
                  "TNPS": 0.7733333333333333,
                  "TX": 0.6380208333333334,
                  "CALIDAD": 0.6137,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "ABANTO ARBOLEDA JOSE CARLOS",
                  "TNPS": 0.6435185185185185,
                  "TX": 0.6865942028985508,
                  "CALIDAD": 0.6166833333333334,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "SOSA RETAMOZO JUAN CARLOS",
                  "TNPS": 0.5359477124183006,
                  "TX": 0.48382126348228044,
                  "CALIDAD": 0.7614500000000001,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "GOMEZ SANCHEZ JUDITH DEL PILAR",
                  "TNPS": 0.7486910994764397,
                  "TX": 0.7103448275862069,
                  "CALIDAD": 0.8150999999999999,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "ZUÑIGA NARVAEZ JULISSA CAROL",
                  "TNPS": 0.8031496062992126,
                  "TX": 0.8263665594855305,
                  "CALIDAD": 0.90625,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "VASQUEZ PINTO JULISSA CAROLINA",
                  "TNPS": 0.6737588652482269,
                  "TX": 0.7835365853658537,
                  "CALIDAD": 0.8314750000000001,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "PEREYRA DIESBACK KAREN ROCIO ROCIO",
                  "TNPS": 0.6611570247933884,
                  "TX": 0.7865353037766831,
                  "CALIDAD": 0.90625,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "SALAZAR DIAZ KAROLAYN RASSHELL",
                  "TNPS": 0.7223484848484849,
                  "TX": 0.7727127148500054,
                  "CALIDAD": 0.74475,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "CORSO MARIANO KATHERINE LOURDES",
                  "TNPS": 0.7384615384615385,
                  "TX": 0.6175438596491228,
                  "CALIDAD": 0.8653,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "RIOS CORDOVA KATHERINE MARIA ANTUANETH",
                  "TNPS": 0.7973856209150327,
                  "TX": 0.6893203883495146,
                  "CALIDAD": 0.9411,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "ZAPATA MORALES KATIA SARITA",
                  "TNPS": 0.6575342465753424,
                  "TX": 0.8313953488372093,
                  "CALIDAD": 0.87835,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "GARRIDO CARDENAS KIMBERLIE ASHLEY",
                  "TNPS": 0.7419354838709677,
                  "TX": 0.7078651685393258,
                  "CALIDAD": 0.7839,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "MENDOZA ROMANI LAURA JANETH",
                  "TNPS": 0.5,
                  "TX": 0.7689015691868759,
                  "CALIDAD": 0.9012000000000001,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "FERNANDEZ AGURTO LEDY ENIT",
                  "TNPS": 0.6556291390728477,
                  "TX": 0.4943639291465378,
                  "CALIDAD": 0.5695,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "LOZANO LAURENTE LEYDY LAURA",
                  "TNPS": 0.5666666666666667,
                  "TX": 0.6431784107946027,
                  "CALIDAD": 0.8836750000000001,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "GUILLEN ZEVALLOS LIZBETH",
                  "TNPS": 0.7372881355932204,
                  "TX": 0.7592592592592593,
                  "CALIDAD": 0.8035000000000001,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "CALDERON MOSCOSO LUANA VALENTINA",
                  "TNPS": 0.5995145631067962,
                  "TX": 0.675834824090638,
                  "CALIDAD": 0.7980499999999999,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "MIRANDA PEÑA LUCERO YUDITH",
                  "TNPS": 0.6789772727272727,
                  "TX": 0.6087962962962963,
                  "CALIDAD": 0.7775,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "DURAN GARCIA LUCIA ESTHER",
                  "TNPS": 0.693069306930693,
                  "TX": 0.7389705882352942,
                  "CALIDAD": 0.8223666666666666,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "HUAMAN GALLEGOS LUIS ANGEL",
                  "TNPS": 0.7363636363636363,
                  "TX": 0.6692015209125475,
                  "CALIDAD": 0.7822,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "PEREDA ARIAS LUIS CESAR",
                  "TNPS": 0.7753623188405797,
                  "TX": 0.8525073746312685,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "GARCÍA CHAPOÑAN MARÍA ISABEL",
                  "TNPS": 0.7089552238805971,
                  "TX": 0.8069815195071869,
                  "CALIDAD": 0.83216,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "GUEVARA TEMOCHE MARIA ALEJANDRA",
                  "TNPS": 0.7723880597014925,
                  "TX": 0.7958477508650519,
                  "CALIDAD": 0.8588250000000001,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "CHAVEZ OLANO MARIA ISABEL",
                  "TNPS": 0.7383512544802867,
                  "TX": 0.8412408759124088,
                  "CALIDAD": 0.9036,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "RONDON CASTILLO MARLIANA",
                  "TNPS": 1,
                  "TX": 1,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "PRADO GARCIA MARTIN JOE",
                  "TNPS": 0.7333333333333333,
                  "TX": 0.8095238095238095,
                  "CALIDAD": 0.84192,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "SAENZ PEÑA MARYCIELO GRETELL",
                  "TNPS": 0.75,
                  "TX": 0.7113702623906706,
                  "CALIDAD": 0.7341,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "DE LA CRUZ GOMEZ MARYORI ELIZABETH",
                  "TNPS": 0.7049180327868853,
                  "TX": 0.8056338028169014,
                  "CALIDAD": 0.9452,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "MERINO HURTADO MAYRA MILAGROS",
                  "TNPS": 0.7475247524752475,
                  "TX": 0.65086887835703,
                  "CALIDAD": 0.6661,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "TORRES QUISPE MELISSA",
                  "TNPS": 0.717741935483871,
                  "TX": 0.7710437710437711,
                  "CALIDAD": 0.81088,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "LA ROSA ARESTEGUI MIGUEL ENRIQUE",
                  "TNPS": 0.840970682434097,
                  "TX": 0.8144753476611883,
                  "CALIDAD": 0.9625,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "SOBRINO VASQUEZ MILUSKA CHEYLA",
                  "TNPS": 0.6428571428571429,
                  "TX": 0.8167006109979633,
                  "CALIDAD": 0.8228666666666666,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "QUIMPER RAMIREZ MONICA NICOL",
                  "TNPS": 0.65625,
                  "TX": 0.7694524495677233,
                  "CALIDAD": 0.925,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "ROSALES PEREZ NAHOMI FABIOLA",
                  "TNPS": 0.675392670157068,
                  "TX": 0.7473460721868365,
                  "CALIDAD": 0.84165,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "OCHOA OCHOA NAOMI CARMEN",
                  "TNPS": 0.5862068965517241,
                  "TX": 0.6259541984732825,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "FARFAN LLOCCLLA NELLY",
                  "TNPS": 0.7317073170731707,
                  "TX": 0.75,
                  "CALIDAD": 0.8714,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "ORDINOLA DIAZ NICOLAS JESUZ",
                  "TNPS": 0.6397849462365591,
                  "TX": 0.544973544973545,
                  "CALIDAD": 0,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "SOBERON RONDON NICOLE ALESSANDRA",
                  "TNPS": 0.7577319587628866,
                  "TX": 0.7462365591397849,
                  "CALIDAD": 0.93845,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "SANTISTEBAN DÁVILA NICOLE SOPHIE",
                  "TNPS": 0.7295635335984928,
                  "TX": 0.8042027828467153,
                  "CALIDAD": 0.9196166666666667,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "ESPINOLA TORRES PABLO ALEJANDRO",
                  "TNPS": 0.6074766355140186,
                  "TX": 0.6666666666666666,
                  "CALIDAD": 0.8652500000000001,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "VILCA LLANTO PERCY",
                  "TNPS": 0.7894736842105263,
                  "TX": 0.6666666666666666,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "CERDAN GUERREROS PIERRE",
                  "TNPS": 0.5836909871244635,
                  "TX": 0.766260162601626,
                  "CALIDAD": 0.7101999999999999,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "CHAVEZ CARRERA DE HARO ROCIO DEL PILAR",
                  "TNPS": 0.7803468208092486,
                  "TX": 0.8567415730337079,
                  "CALIDAD": 0.6528,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "VALER ROJAS ROGER FELIX",
                  "TNPS": 0.6854460093896714,
                  "TX": 0.7377963737796374,
                  "CALIDAD": 0.9552400000000001,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "HUAMANI CASTAÑEDA ROSALYN PAOLA",
                  "TNPS": 0.3611111111111111,
                  "TX": 0.7038043478260869,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "ADRIANZEN LEON ROXANA ELIZABETH",
                  "TNPS": 0.8478260869565217,
                  "TX": 0.7404580152671756,
                  "CALIDAD": 0.575,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "DAVILA IRARICA RUDY AURISTELA",
                  "TNPS": 0.8467153284671532,
                  "TX": 0.6595744680851063,
                  "CALIDAD": 0.8173,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "HUERE VASCO SANDY CELENE",
                  "TNPS": 0.8125,
                  "TX": 0.784452296819788,
                  "CALIDAD": "#N\/A",
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "DIAZ MEZA SANTOS ENRIQUE",
                  "TNPS": 0.5319148936170213,
                  "TX": 0.7019438444924406,
                  "CALIDAD": 0.85985,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "VILLACORTA CHAVEZ SEBASTIAN ALESSANDRO",
                  "TNPS": 0.45614035087719296,
                  "TX": 0.6470588235294118,
                  "CALIDAD": 0.9125,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "VENTURA CHAMBI SERGIO MANUEL",
                  "TNPS": 0.6666666666666666,
                  "TX": 0.89,
                  "CALIDAD": 0.9125,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "NUNTA CURAHUA SHARON MISHEL",
                  "TNPS": 0.7658536585365854,
                  "TX": 0.7097989949748744,
                  "CALIDAD": 0.9099999999999999,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 },
                 {
                  "ASESOR": "GISMONDI ESPINOZA SONIA JANET",
                  "TNPS": 0.5592592592592592,
                  "TX": 0.7110215053763441,
                  "CALIDAD": 0.9005375,
                  "SUPERVISOR": "PARRA PAREDES RAUL JESUS"
                 },
                 {
                  "ASESOR": "CHAVEZ SANTA MARIA SUSAN ABIGAIL",
                  "TNPS": 0.8306451612903225,
                  "TX": 0.7719512195121951,
                  "CALIDAD": 0.8274,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "ROSPIGLIOSI LEON VALERIA GIOVANNA",
                  "TNPS": 0.5665024630541872,
                  "TX": 0.7033492822966507,
                  "CALIDAD": 0.8073,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "PAUCCA HUERTAS VICTOR MANUEL",
                  "TNPS": 0.6413043478260869,
                  "TX": 0.8117647058823529,
                  "CALIDAD": 0.9084,
                  "SUPERVISOR": "SULCA VEGA JULIO LEONARDO"
                 },
                 {
                  "ASESOR": "ROSALES ANCHANTE VIVIANA PILAR",
                  "TNPS": 0.7889273356401384,
                  "TX": 0.7806873977086743,
                  "CALIDAD": 0.92,
                  "SUPERVISOR": "ULFFE QUISPE IAN ALEXEI"
                 },
                 {
                  "ASESOR": "MONRROY MONASTERIO YOELYS EUGENIA",
                  "TNPS": 0.7745098039215687,
                  "TX": 0.6926229508196722,
                  "CALIDAD": 0.775,
                  "SUPERVISOR": "VERASTEGUI TANTAVILCA STEPHANIE DJAMILA"
                 },
                 {
                  "ASESOR": "MORILLO LUCENA YOSELYN LORENA",
                  "TNPS": 0.6649746192893401,
                  "TX": 0.5445682451253482,
                  "CALIDAD": 0.902225,
                  "SUPERVISOR": "HERNANDEZ AHUANARI ANYELI NAOMI"
                 }
            ]
        };

        const metaTNPS = 73;
        const metaTX = 79;
        const metaCalidad = 84;

        function cargarSupervisores() {
            const supervisores = [...new Set(data.Hoja2.map(item => item.SUPERVISOR))];
            const select = document.getElementById('supervisor');
            supervisores.forEach(supervisor => {
                const option = new Option(supervisor, supervisor);
                select.add(option);
            });
        }

        function cargarAsesores() {
            const supervisor = document.getElementById('supervisor').value;
            const select = document.getElementById('asesor');
            select.innerHTML = '<option value="">Seleccionar...</option>';
            
            data.Hoja2.filter(item => item.SUPERVISOR === supervisor).forEach(asesor => {
                select.add(new Option(asesor.ASESOR, asesor.ASESOR));
            });
            if(myChart) myChart.destroy();
        }

        function actualizarDashboard() {
            const asesor = document.getElementById('asesor').value;
            const datos = data.Hoja2.find(item => item.ASESOR === asesor);
            
            if(!datos) return;
            
            const tnps = (datos.TNPS * 100).toFixed(1);
            const tx = (datos.TX * 100).toFixed(1);
            const calidad = (datos.CALIDAD * 100).toFixed(1);
            
            actualizarMetricas(tnps, tx, calidad);
            actualizarGrafico(tnps, tx, calidad);
            mostrarAlerta(tnps, tx, calidad);
        }

        function actualizarMetricas(tnps, tx, calidad) {
            document.getElementById('tnps-value').textContent = `${tnps}%`;
            document.getElementById('tx-value').textContent = `${tx}%`;
            document.getElementById('calidad-value').textContent = `${calidad}%`;
        }

        function actualizarGrafico(tnps, tx, calidad) {
            const ctx = document.getElementById('chart').getContext('2d');
            if(myChart) myChart.destroy();

            myChart = new Chart(ctx, {
                type: 'bar',
                plugins: [ChartDataLabels],
                data: {
                    labels: ['TNPS', 'TX', 'Calidad'],
                    datasets: [{
                        label: 'Actual',
                        data: [tnps, tx, calidad],
                        backgroundColor: [ '#3498db', '#2ecc71', '#9b59b6' ],
                        borderWidth: 0,
                        borderRadius: 4,
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            formatter: (value, context) => {
                                const label = context.chart.data.labels[context.dataIndex];
                                return `${label}\n${value}%`;
                            },
                            color: '#fff',
                            font: {
                                size: 20,
                                weight: 'bold'
                            },
                            padding: {
                                top: 10,
                                bottom: 10
                            }
                        }
                    },
                    {
                        label: 'Meta',
                        data: [metaTNPS, metaTX, metaCalidad],
                        backgroundColor: '#e74c3c',
                        type: 'line',
                        borderColor: '#e74c3c',
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.4,
                        datalabels: {
                            display: false
                        }
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: { color: '#f0f0f0' },
                            ticks: { color: '#7f8c8d' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        datalabels: {
                            display: true,
                            clamp: true,
                            clip: false
                        },
                        legend: {
                            position: 'top',
                            labels: { color: '#2c3e50' }
                        },
                        tooltip: {
                            backgroundColor: '#2c3e50',
                            titleFont: { weight: 'normal' }
                        }
                    }
                }
            });
        }

        function mostrarAlerta(tnps, tx, calidad) {
            const alerta = document.getElementById('alert');
            const cumplido = tnps >= metaTNPS && tx >= metaTX && calidad >= metaCalidad;
            
            alerta.className = 'alert ' + (cumplido ? 'success' : 'warning');
            alerta.innerHTML = `
                ${cumplido ? '✓' : '⚠'} 
                ${cumplido 
                    ? '¡Todos los objetivos cumplidos!' 
                    : `Necesitas mejorar: 
                        ${tnps < metaTNPS ? `TNPS +${(metaTNPS - tnps).toFixed(1)}% ` : ''}
                        ${tx < metaTX ? `TX +${(metaTX - tx).toFixed(1)}% ` : ''}
                        ${calidad < metaCalidad ? `Calidad +${(metaCalidad - calidad).toFixed(1)}%` : ''}`}
            `;
        }

        window.onload = cargarSupervisores;
    </script>
</body>
</html>
